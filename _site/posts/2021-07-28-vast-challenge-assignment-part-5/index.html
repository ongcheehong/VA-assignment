<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>VA assignment: Vast Challenge Assignment Part 5</title>

<meta property="description" itemprop="description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-07-28"/>
<meta property="article:created" itemprop="dateCreated" content="2021-07-28"/>
<meta name="article:author" content="Ong Chee Hong"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="VA assignment: Vast Challenge Assignment Part 5"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="VA assignment"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="VA assignment: Vast Challenge Assignment Part 5"/>
<meta property="twitter:description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Vast Challenge Assignment Part 5"]},{"type":"character","attributes":{},"value":["Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Ong Chee Hong"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/alexongch/"]}]}]},{"type":"character","attributes":{},"value":["07-28-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/MC2/~$2_data_readme.docx","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet.htm","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/colorschememapping.xml","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/filelist.xml","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/themedata.thmx","data/MC2/car-assignments.csv","data/MC2/cc_data.csv","data/MC2/Geospatial/Abila.dbf","data/MC2/Geospatial/Abila.kml","data/MC2/Geospatial/Abila.prj","data/MC2/Geospatial/Abila.sbn","data/MC2/Geospatial/Abila.sbx","data/MC2/Geospatial/Abila.shp","data/MC2/Geospatial/Abila.shx","data/MC2/Geospatial/Kronos Island.kmz","data/MC2/Geospatial/Kronos_Island.dbf","data/MC2/Geospatial/Kronos_Island.prj","data/MC2/Geospatial/Kronos_Island.sbn","data/MC2/Geospatial/Kronos_Island.sbx","data/MC2/Geospatial/Kronos_Island.shp","data/MC2/Geospatial/Kronos_Island.shx","data/MC2/Geospatial/MC2-tourist_modified.tif","data/MC2/Geospatial/MC2-tourist_modified.tif.points","data/MC2/gps.csv","data/MC2/loyalty_data.csv","data/MC2/MC2-tourist.jpg","data/MC2/MC2-tourist_modified.tif","data/MC2/MC2-tourist_modified.tif.points","data/MC2/MC2_data_readme.docx","img/101_106_107.png","img/107 data.png","img/107 map.png","img/14 network.png","img/16.png","img/17 data.png","img/17 map.png","img/17 network.png","img/18 network.png","img/18.png","img/21 map.png","img/21.png","img/24.png","img/26 canero street.png","img/26 network.png","img/5.png","img/8 data.png","img/8 map.png","img/8 network 2.png","img/8 network.png","img/bar chart.PNG","img/bar.png","img/day 10.png","img/Density plot.jpg","img/geo.PNG","img/katerine.png","img/line chart.PNG","img/localization.png","img/map tif.png","img/MC2-tourist.jpg","img/network.PNG","img/Ouzeri Elian.png","img/uturn.png","vast-challenge-assignment-part-5_files/anchor/anchor.min.js","vast-challenge-assignment-part-5_files/bowser/bowser.min.js","vast-challenge-assignment-part-5_files/crosstalk/css/crosstalk.css","vast-challenge-assignment-part-5_files/crosstalk/js/crosstalk.js","vast-challenge-assignment-part-5_files/crosstalk/js/crosstalk.js.map","vast-challenge-assignment-part-5_files/crosstalk/js/crosstalk.min.js","vast-challenge-assignment-part-5_files/crosstalk/js/crosstalk.min.js.map","vast-challenge-assignment-part-5_files/distill/template.v2.js","vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-25-1.png","vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-26-1.png","vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-27-1.png","vast-challenge-assignment-part-5_files/header-attrs/header-attrs.js","vast-challenge-assignment-part-5_files/htmlwidgets/htmlwidgets.js","vast-challenge-assignment-part-5_files/jquery/jquery-AUTHORS.txt","vast-challenge-assignment-part-5_files/jquery/jquery.js","vast-challenge-assignment-part-5_files/jquery/jquery.min.js","vast-challenge-assignment-part-5_files/jquery/jquery.min.map","vast-challenge-assignment-part-5_files/plotly-binding/plotly.js","vast-challenge-assignment-part-5_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css","vast-challenge-assignment-part-5_files/plotly-main/plotly-latest.min.js","vast-challenge-assignment-part-5_files/popper/popper.min.js","vast-challenge-assignment-part-5_files/tippy/tippy-bundle.umd.min.js","vast-challenge-assignment-part-5_files/tippy/tippy-light-border.css","vast-challenge-assignment-part-5_files/tippy/tippy.css","vast-challenge-assignment-part-5_files/tippy/tippy.umd.min.js","vast-challenge-assignment-part-5_files/typedarray/typedarray.min.js","vast-challenge-assignment-part-5_files/webcomponents/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs/header-attrs.js"></script>
  <script src="../../site_libs/htmlwidgets/htmlwidgets.js"></script>
  <script src="../../site_libs/plotly-binding/plotly.js"></script>
  <script src="../../site_libs/typedarray/typedarray.min.js"></script>
  <script src="../../site_libs/jquery/jquery.min.js"></script>
  <link href="../../site_libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
  <script src="../../site_libs/crosstalk/js/crosstalk.min.js"></script>
  <link href="../../site_libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
  <script src="../../site_libs/plotly-main/plotly-latest.min.js"></script>
  <link href="../../site_libs/vis/vis.css" rel="stylesheet" />
  <script src="../../site_libs/vis/vis.min.js"></script>
  <script src="../../site_libs/visNetwork-binding/visNetwork.js"></script>
  <script src="../../site_libs/popper/popper.min.js"></script>
  <link href="../../site_libs/tippy/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor/anchor.min.js"></script>
  <script src="../../site_libs/bowser/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents/webcomponents.js"></script>
  <script src="../../site_libs/distill/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Vast Challenge Assignment Part 5","description":"Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment.","authors":[{"author":"Ong Chee Hong","authorURL":"https://www.linkedin.com/in/alexongch/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-28T00:00:00.000+08:00","citationText":"Hong, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">VA assignment</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Vast Challenge Assignment Part 5</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Welcome to Ong Chee Hongs Vast Challenge 2021 Assignment.</p></p>
</div>

<div class="d-byline">
  Ong Chee Hong <a href="https://www.linkedin.com/in/alexongch/" class="uri">https://www.linkedin.com/in/alexongch/</a> 
  
<br/>07-28-2021
</div>

<div class="d-article">
<h1 id="data-preparation-for-question-4.4">Data Preparation for Question 4.4</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'DT'</span>,<span class='st'>'ggiraph'</span>,<span class='st'>'plotly'</span>,<span class='st'>'tidyverse'</span>, <span class='st'>'raster'</span>,<span class='st'>'sf'</span>,<span class='st'>'clock'</span>,<span class='st'>'tmap'</span>,
             <span class='st'>'rgdal'</span>,<span class='st'>'dplyr'</span>, <span class='st'>'tidyr'</span>, <span class='st'>'textclean'</span>, <span class='st'>"plotly"</span>, <span class='st'>"forcats"</span>, <span class='st'>"jpeg"</span>, <span class='st'>"tiff"</span>,
             <span class='st'>"mapview"</span>,<span class='st'>"tidygraph"</span>,<span class='st'>"igraph"</span>,<span class='st'>"ggraph"</span>,<span class='st'>"visNetwork"</span>,<span class='st'>"lubridate"</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/car-assignments.csv"</span><span class='op'>)</span>
<span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/cc_data.csv"</span>, locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gps</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/gps.csv"</span><span class='op'>)</span>
<span class='va'>loyalty</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/loyalty_data.csv"</span>,locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc</span><span class='op'>$</span><span class='va'>last4ccnum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>last4ccnum</span><span class='op'>)</span>
<span class='va'>loyalty</span><span class='op'>$</span><span class='va'>loyaltynum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>$</span><span class='va'>loyaltynum</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                 zone <span class='op'>=</span> <span class='st'>""</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y %H:%M"</span><span class='op'>)</span>

<span class='va'>loyalty</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_parse</span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_dtsplit</span> <span class='op'>&lt;-</span> <span class='va'>cc</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>day <span class='op'>=</span> <span class='fu'>date_weekday_factor</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>, date <span class='op'>=</span>  <span class='fu'>as_date</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>, time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span>, format <span class='op'>=</span> <span class='st'>"%H:%M"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_dtsplit</span>
</code></pre>
</div>
<pre><code># A tibble: 1,490 x 7
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:34:00 Hallowed Gro~ 52.2  7108       Mon   2014-01-06
 3 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 4 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 5 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 6 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 7 2014-01-06 07:42:00 Coffee Camel~ 28.7  7253       Mon   2014-01-06
 8 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 9 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
10 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
# ... with 1,480 more rows, and 1 more variable: time &lt;chr&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loyalty_dt</span> <span class='op'>&lt;-</span> <span class='fu'>rename</span><span class='op'>(</span><span class='va'>loyalty</span>, date <span class='op'>=</span> <span class='va'>timestamp</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span><span class='op'>$</span><span class='va'>CarID</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car</span><span class='op'>$</span><span class='va'>CarID</span><span class='op'>)</span>
<span class='va'>gps</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>gps</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_unite</span> <span class='op'>&lt;-</span> <span class='va'>car</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"name"</span>, <span class='va'>LastName</span>,<span class='va'>FirstName</span>, sep <span class='op'>=</span> <span class='st'>", "</span>,  remove <span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_cleaned</span> <span class='op'>&lt;-</span> <span class='fu'>rename</span><span class='op'>(</span><span class='va'>gps</span>,CarID <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span>

<span class='va'>gps_cleaned</span><span class='op'>$</span><span class='va'>Timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>gps_cleaned</span><span class='op'>$</span><span class='va'>Timestamp</span>,
                                 zone <span class='op'>=</span> <span class='st'>""</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y %H:%M"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_dtsplit_bar</span> <span class='op'>&lt;-</span> <span class='va'>cc_dtsplit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by location"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_dtsplit_bar</span>
</code></pre>
</div>
<div id="htmlwidget-ff4c67987215cf53df6f" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ff4c67987215cf53df6f">{"x":{"visdat":{"102102994210b":["function () ","plotlyVisDat"]},"cur_data":"102102994210b","attrs":{"102102994210b":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by location","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Guy's Gyros","Brew've Been Served","Hallowed Grounds","Ouzeri Elian","Abila Zacharo","Gelatogalore","Kalami Kafenion","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Brewed Awakenings","Abila Airport","Albert's Fine Clothing","Nationwide Refinery","Shoppers' Delight","Carlyle Chemical Inc.","Stewart and Sons Fabrication","General Grocer","Kronos Mart","Chostus Hotel","Coffee Shack","Desafio Golf Course","Roberts and Sons","Ahaggo Museum","Kronos Pipe and Irrigation","Maximum Iron and Steel","Abila Scrapyard","Octavio's Office Supplies","Frank's Fuel","U-Pump","Daily Dealz"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Daily Dealz","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],"marker":{"color":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loyalty_dt_bar</span> <span class='op'>&lt;-</span> <span class='va'>loyalty_dt</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by "</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>loyalty_dt_bar</span>
</code></pre>
</div>
<div id="htmlwidget-531eb2e1da70d72506f5" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-531eb2e1da70d72506f5">{"x":{"visdat":{"1021066ca575c":["function () ","plotlyVisDat"]},"cur_data":"1021066ca575c","attrs":{"1021066ca575c":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by ","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Guy's Gyros","Brew've Been Served","Ouzeri Elian","Hallowed Grounds","Abila Zacharo","Kalami Kafenion","Gelatogalore","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Brewed Awakenings","Abila Airport","Albert's Fine Clothing","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Stewart and Sons Fabrication","General Grocer","Coffee Shack","Chostus Hotel","Desafio Golf Course","Kronos Mart","Ahaggo Museum","Kronos Pipe and Irrigation","Maximum Iron and Steel","Roberts and Sons","Abila Scrapyard","Octavio's Office Supplies","Frank's Fuel","U-Pump"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],"marker":{"color":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_join</span> <span class='op'>&lt;-</span> <span class='va'>cc_dtsplit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>loyalty_dt</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span>,<span class='st'>"location"</span>, <span class='st'>"price"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_loyalty_join</span>
</code></pre>
</div>
<pre><code># A tibble: 1,087 x 8
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,077 more rows, and 2 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_cc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"CarID"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>10</span>,<span class='fl'>10</span>,<span class='fl'>11</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>13</span>,<span class='fl'>13</span>,<span class='fl'>14</span>,<span class='fl'>14</span>,<span class='fl'>14</span>,<span class='fl'>15</span>,<span class='fl'>15</span>,<span class='fl'>16</span>,<span class='fl'>16</span>,<span class='fl'>17</span>,<span class='fl'>18</span>,<span class='fl'>18</span>,<span class='fl'>18</span>,<span class='fl'>18</span>,<span class='fl'>19</span>,<span class='fl'>21</span>,<span class='fl'>22</span>,<span class='fl'>22</span>,
                                 <span class='fl'>25</span>,<span class='fl'>25</span>,<span class='fl'>25</span>,<span class='fl'>26</span>,<span class='fl'>26</span>,<span class='fl'>27</span>,<span class='fl'>29</span>,<span class='fl'>29</span>,<span class='fl'>29</span>,<span class='fl'>30</span>,<span class='fl'>30</span>,<span class='fl'>30</span>,<span class='fl'>30</span>,<span class='fl'>31</span>,<span class='fl'>33</span>,<span class='fl'>34</span>,<span class='fl'>35</span>,<span class='fl'>101</span>,<span class='fl'>101</span>,<span class='fl'>104</span>,<span class='fl'>105</span>,<span class='fl'>106</span>,<span class='fl'>106</span>,<span class='fl'>107</span><span class='op'>)</span>,<span class='st'>"last4ccnum"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7108</span>,<span class='fl'>9551</span>,<span class='fl'>2681</span>,<span class='fl'>1415</span>,<span class='fl'>9635</span>,<span class='fl'>8156</span>,<span class='fl'>7688</span>,<span class='fl'>6899</span>,<span class='fl'>7117</span>,<span class='fl'>7253</span>,<span class='fl'>2540</span>,<span class='fl'>5368</span>,<span class='fl'>5368</span>,<span class='fl'>1877</span>,<span class='fl'>8332</span>,<span class='fl'>8332</span>,<span class='fl'>1321</span>,<span class='fl'>7108</span>,<span class='fl'>5407</span>,<span class='fl'>8202</span>,<span class='fl'>6691</span>,<span class='fl'>7889</span>,<span class='fl'>7889</span>,<span class='fl'>1874</span>,<span class='fl'>3853</span>,<span class='fl'>8129</span>,<span class='fl'>4795</span>,<span class='fl'>4795</span>,
  <span class='fl'>7384</span>,<span class='fl'>9617</span>,<span class='fl'>7354</span>,<span class='fl'>4434</span>,<span class='fl'>7792</span>,<span class='fl'>6895</span>,<span class='fl'>9405</span>,<span class='fl'>1286</span>,<span class='fl'>1286</span>,<span class='fl'>6816</span>,<span class='fl'>2418</span>,<span class='fl'>2142</span>,<span class='fl'>7819</span>,<span class='fl'>1310</span>,<span class='fl'>3492</span>, <span class='fl'>3547</span>,<span class='fl'>5921</span>,<span class='fl'>5921</span>,<span class='fl'>8411</span>,<span class='fl'>4948</span>,<span class='fl'>4948</span>,<span class='fl'>6901</span>,<span class='fl'>5010</span>,<span class='fl'>9683</span>,<span class='fl'>3484</span>,<span class='fl'>2463</span>,<span class='fl'>9220</span>,<span class='fl'>9220</span>,<span class='fl'>8642</span>,<span class='fl'>9152</span>,<span class='fl'>2276</span>,<span class='fl'>3506</span>,<span class='fl'>4530</span><span class='op'>)</span>, <span class='st'>"loyaltynum"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"L6544"</span>,<span class='st'>"L5777"</span>,<span class='st'>"L1107"</span>,<span class='st'>"L7783"</span>,<span class='st'>"L3191"</span>,<span class='st'>"L5224"</span>,<span class='st'>"L4164"</span>, <span class='st'>"L6267"</span>,<span class='st'>"L6417"</span>,<span class='st'>"L1682"</span>,<span class='st'>"L5947"</span>, <span class='st'>"L2247"</span>,<span class='st'>"L6119"</span>,<span class='st'>"L3014"</span>,<span class='st'>"L2070"</span>,<span class='st'>"L8566"</span>,<span class='st'>"L4149"</span>,<span class='st'>"L6544"</span>,<span class='st'>"L4034"</span>,<span class='st'>"L2343"</span>,<span class='st'>"L6267"</span>,<span class='st'>"L6119"</span>,<span class='st'>"L2247"</span>,<span class='st'>"L4424"</span>,<span class='st'>"L1485"</span>,<span class='st'>"L8328"</span>,<span class='st'>"L8566"</span>,<span class='st'>"L2070"</span>,<span class='st'>"L3800"</span>,<span class='st'>"L5553"</span>,<span class='st'>"L9254"</span>,<span class='st'>"L2169"</span>,<span class='st'>"L5756"</span>,<span class='st'>"L3366"</span>,<span class='st'>"L3259"</span>,<span class='st'>"L3288"</span>,<span class='st'>"L3572"</span>,<span class='st'>"L8148"</span>,<span class='st'>"L9018"</span>,<span class='st'>"L9637"</span>,<span class='st'>"L5259"</span>,<span class='st'>"L8012"</span>,<span class='st'>"L7814"</span>,<span class='st'>"L9362"</span>,<span class='st'>"L3295"</span>,<span class='st'>"L9406"</span>,<span class='st'>"L6110"</span>,<span class='st'>"L9406"</span>,<span class='st'>"L3295"</span>,<span class='st'>"L9363"</span>,<span class='st'>"L2459"</span>,<span class='st'>"L7291"</span>,<span class='st'>"L2490"</span>,<span class='st'>"L6886"</span>,<span class='st'>"L4063"</span>,<span class='st'>"L7761"</span>,<span class='st'>"L2769"</span>,<span class='st'>"L5485"</span>,<span class='st'>"L3317"</span>,<span class='st'>"L7761"</span>,<span class='st'>"L8477"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>car_cc</span><span class='op'>$</span><span class='va'>last4ccnum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car_cc</span><span class='op'>$</span><span class='va'>last4ccnum</span><span class='op'>)</span>
<span class='va'>car_cc</span><span class='op'>$</span><span class='va'>loyaltynum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car_cc</span><span class='op'>$</span><span class='va'>loyaltynum</span><span class='op'>)</span>

<span class='va'>car_cc</span>
</code></pre>
</div>
<pre><code>   CarID last4ccnum loyaltynum
1      1       7108      L6544
2      1       9551      L5777
3      1       2681      L1107
4      2       1415      L7783
5      3       9635      L3191
6      4       8156      L5224
7      4       7688      L4164
8      5       6899      L6267
9      5       7117      L6417
10     6       7253      L1682
11     7       2540      L5947
12     8       5368      L2247
13     8       5368      L6119
14     9       1877      L3014
15    10       8332      L2070
16    10       8332      L8566
17    11       1321      L4149
18    12       7108      L6544
19    13       5407      L4034
20    13       8202      L2343
21    13       6691      L6267
22    14       7889      L6119
23    14       7889      L2247
24    14       1874      L4424
25    15       3853      L1485
26    15       8129      L8328
27    16       4795      L8566
28    16       4795      L2070
29    17       7384      L3800
30    18       9617      L5553
31    18       7354      L9254
32    18       4434      L2169
33    18       7792      L5756
34    19       6895      L3366
35    21       9405      L3259
36    22       1286      L3288
37    22       1286      L3572
38    25       6816      L8148
39    25       2418      L9018
40    25       2142      L9637
41    26       7819      L5259
42    26       1310      L8012
43    27       3492      L7814
44    29       3547      L9362
45    29       5921      L3295
46    29       5921      L9406
47    30       8411      L6110
48    30       4948      L9406
49    30       4948      L3295
50    30       6901      L9363
51    31       5010      L2459
52    33       9683      L7291
53    34       3484      L2490
54    35       2463      L6886
55   101       9220      L4063
56   101       9220      L7761
57   104       8642      L2769
58   105       9152      L5485
59   106       2276      L3317
60   106       3506      L7761
61   107       4530      L8477</code></pre>
</div>
<h1 id="given-the-data-sources-provided-identify-potential-informal-or-unofficial-relationships-among-gastech-personnel.-provide-evidence-for-these-relationships.-please-limit-your-response-to-8-images-and-500-words.">4.4. Given the data sources provided, identify potential informal or unofficial relationships among GASTech personnel. Provide evidence for these relationships. Please limit your response to 8 images and 500 words.</h1>
<p>Network analysis is used to detect relationship between people of interests.</p>
<p>To start our journey of network analysis. We will first fulljoin the dataset of cc_loyalty_join to car_cc. The full join will indicates an NA that does not have any data on the other dataset.On the below tibble, we will be able to note that there are CarIDs that have NA. The reason being those are likely truck drivers in which the car_cc dataset do not have any indicative value for that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_cc_join</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>car_cc</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"last4ccnum"</span> , <span class='st'>"loyaltynum"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>car_cc_join</span>
</code></pre>
</div>
<pre><code># A tibble: 1,104 x 9
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,094 more rows, and 3 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;, CarID &lt;dbl&gt;</code></pre>
</div>
<p>We will take a look at those CarID with NA values. There are a total of some of the rows that the CarID cant be inferred.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_cc_na</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>full_join</span><span class='op'>(</span><span class='va'>car_cc</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"last4ccnum"</span> , <span class='st'>"loyaltynum"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CarID</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>car_cc_na</span>
</code></pre>
</div>
<pre><code># A tibble: 31 x 9
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 10:02:00 Nationwide ~  762.  9735       Mon   2014-01-06
 2 2014-01-06 11:33:00 Stewart and~ 2145.  9735       Mon   2014-01-06
 3 2014-01-06 12:00:00 Jack&#39;s Magi~   18.6 9241       Mon   2014-01-06
 4 2014-01-07 10:11:00 Nationwide ~ 1347.  9735       Tue   2014-01-07
 5 2014-01-07 12:00:00 Jack&#39;s Magi~   18.8 9241       Tue   2014-01-07
 6 2014-01-07 20:15:00 Ouzeri Elian   11.4 9241       Tue   2014-01-07
 7 2014-01-08 10:14:00 Nationwide ~ 3674.  9735       Wed   2014-01-08
 8 2014-01-08 11:58:00 Stewart and~ 1674.  9735       Wed   2014-01-08
 9 2014-01-08 12:00:00 Jack&#39;s Magi~   18.8 9241       Wed   2014-01-08
10 2014-01-09 10:16:00 Nationwide ~  674.  9735       Thu   2014-01-09
# ... with 21 more rows, and 3 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;, CarID &lt;dbl&gt;</code></pre>
</div>
<p>We will drop those NA data that cant be inferred. We have atotal of 1073 rows in our joined dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_cc_dropna</span> <span class='op'>&lt;-</span> <span class='va'>car_cc_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>CarID</span><span class='op'>)</span> 

<span class='va'>car_cc_dropna</span><span class='op'>$</span><span class='va'>CarID</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car_cc_dropna</span><span class='op'>$</span><span class='va'>CarID</span><span class='op'>)</span>

<span class='va'>car_cc_dropna</span> 
</code></pre>
</div>
<pre><code># A tibble: 1,073 x 9
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,063 more rows, and 3 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;, CarID &lt;fct&gt;</code></pre>
</div>
<p>Next, we will select out those data from the car assignment dataset that we are required for our network analysis study.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_unite_select</span> <span class='op'>&lt;-</span> <span class='va'>car_unite</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>name</span>, <span class='va'>CarID</span>, <span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span><span class='op'>)</span>

<span class='va'>car_unite_select</span>
</code></pre>
</div>
<pre><code># A tibble: 44 x 4
   name              CarID CurrentEmploymentType CurrentEmploymentTit~
   &lt;chr&gt;             &lt;fct&gt; &lt;chr&gt;                 &lt;chr&gt;                
 1 Calixto, Nils     1     Information Technolo~ IT Helpdesk          
 2 Azada, Lars       2     Engineering           Engineer             
 3 Balas, Felix      3     Engineering           Engineer             
 4 Barranco, Ingrid  4     Executive             SVP/CFO              
 5 Baza, Isak        5     Information Technolo~ IT Technician        
 6 Bergen, Linnea    6     Information Technolo~ IT Group Manager     
 7 Orilla, Elsa      7     Engineering           Drill Technician     
 8 Alcazar, Lucas    8     Information Technolo~ IT Technician        
 9 Cazar, Gustav     9     Engineering           Drill Technician     
10 Campo-Corrente, ~ 10    Executive             SVP/CIO              
# ... with 34 more rows</code></pre>
</div>
<p>We will next join the car_cc dataset with the car assignment dataset. Notice that there is a reduction in number of rows, those rows that are taken out are trucks which does not have any CarID.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>carassgn_car_cc_join</span> <span class='op'>&lt;-</span> <span class='va'>car_cc_dropna</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>car_unite_select</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CarID"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>carassgn_car_cc_join</span>
</code></pre>
</div>
<pre><code># A tibble: 1,023 x 12
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,013 more rows, and 6 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;, CarID &lt;fct&gt;, name &lt;chr&gt;,
#   CurrentEmploymentType &lt;chr&gt;, CurrentEmploymentTitle &lt;chr&gt;</code></pre>
</div>
<p>How do we find out the relationship between a person to another. Normally, when friends went out together to have lunch, they will pay separetely on the spot. This is indicative of a close relationship. For our study, we will cut the transaction time in breaks of 5 mins to try and sieve out those similar transactions that might be indicative of a close relationship between people.</p>
<p>To do that, we will need to cut the timestamp by 5mins break as shown below. You will notice that a new row time_5 is created and break by 5 mins.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ccassgn_5min</span> <span class='op'>&lt;-</span> <span class='va'>carassgn_car_cc_join</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>time_5 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>timestamp</span>, breaks<span class='op'>=</span><span class='st'>"5 min"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>ccassgn_5min</span>
</code></pre>
</div>
<pre><code># A tibble: 1,023 x 13
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,013 more rows, and 7 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;, CarID &lt;fct&gt;, name &lt;chr&gt;,
#   CurrentEmploymentType &lt;chr&gt;, CurrentEmploymentTitle &lt;chr&gt;,
#   time_5 &lt;fct&gt;</code></pre>
</div>
<p>Next, we will filter out those columns that are required for our network analysis study.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ccassgn_5min_select</span> <span class='op'>&lt;-</span> <span class='va'>ccassgn_5min</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>CarID</span>,<span class='va'>time_5</span>,<span class='va'>location</span>,<span class='va'>name</span>,<span class='va'>day</span><span class='op'>)</span>

<span class='va'>ccassgn_5min_select</span>
</code></pre>
</div>
<pre><code># A tibble: 1,023 x 5
   CarID time_5              location            name            day  
   &lt;fct&gt; &lt;fct&gt;               &lt;chr&gt;               &lt;chr&gt;           &lt;ord&gt;
 1 16    2014-01-06 07:28:00 Brew&#39;ve Been Served Vann, Isia      Mon  
 2 25    2014-01-06 07:33:00 Brew&#39;ve Been Served Herrero, Kanon  Mon  
 3 18    2014-01-06 07:33:00 Hallowed Grounds    Frente, Birgit~ Mon  
 4 17    2014-01-06 07:33:00 Brew&#39;ve Been Served Flecha, Sven    Mon  
 5 8     2014-01-06 07:38:00 Brew&#39;ve Been Served Alcazar, Lucas  Mon  
 6 30    2014-01-06 07:43:00 Brew&#39;ve Been Served Resumir, Felix  Mon  
 7 33    2014-01-06 07:43:00 Brew&#39;ve Been Served Tempestad, Bra~ Mon  
 8 15    2014-01-06 07:43:00 Hallowed Grounds    Bodrogi, Loreto Mon  
 9 27    2014-01-06 07:48:00 Hallowed Grounds    Orilla, Kare    Mon  
10 29    2014-01-06 07:48:00 Coffee Cameleon     Ovan, Bertrand  Mon  
# ... with 1,013 more rows</code></pre>
</div>
<p>Next, we will join the same table with each other to examine any close relationship between each other. Notice that there are CarID_1 and CarID_2. As there should not be two CarID that are the same with each other. We will take it out on the next code chunk.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_location_edges</span> <span class='op'>&lt;-</span> <span class='va'>ccassgn_5min_select</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>ccassgn_5min_select</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_5"</span>,<span class='st'>"location"</span>,<span class='st'>"day"</span><span class='op'>)</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"_1"</span>,<span class='st'>"_2"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>car_location_edges</span>
</code></pre>
</div>
<pre><code># A tibble: 1,577 x 7
   CarID_1 time_5      location     name_1     day   CarID_2 name_2   
   &lt;fct&gt;   &lt;fct&gt;       &lt;chr&gt;        &lt;chr&gt;      &lt;ord&gt; &lt;fct&gt;   &lt;chr&gt;    
 1 16      2014-01-06~ Brew&#39;ve Bee~ Vann, Isia Mon   16      Vann, Is~
 2 25      2014-01-06~ Brew&#39;ve Bee~ Herrero, ~ Mon   25      Herrero,~
 3 25      2014-01-06~ Brew&#39;ve Bee~ Herrero, ~ Mon   17      Flecha, ~
 4 18      2014-01-06~ Hallowed Gr~ Frente, B~ Mon   18      Frente, ~
 5 17      2014-01-06~ Brew&#39;ve Bee~ Flecha, S~ Mon   25      Herrero,~
 6 17      2014-01-06~ Brew&#39;ve Bee~ Flecha, S~ Mon   17      Flecha, ~
 7 8       2014-01-06~ Brew&#39;ve Bee~ Alcazar, ~ Mon   8       Alcazar,~
 8 30      2014-01-06~ Brew&#39;ve Bee~ Resumir, ~ Mon   30      Resumir,~
 9 30      2014-01-06~ Brew&#39;ve Bee~ Resumir, ~ Mon   33      Tempesta~
10 33      2014-01-06~ Brew&#39;ve Bee~ Tempestad~ Mon   30      Resumir,~
# ... with 1,567 more rows</code></pre>
</div>
<p>Next, we will group the two carids together with the time, location and day to find out those carids that goes to the same place around the same time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_location_edges_aggregated</span> <span class='op'>&lt;-</span> <span class='va'>car_location_edges</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>CarID_1</span>, <span class='va'>CarID_2</span>, <span class='va'>time_5</span>, <span class='va'>location</span>, <span class='va'>day</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarise</span><span class='op'>(</span>Weight <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>CarID_1</span> <span class='op'>!=</span> <span class='va'>CarID_2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>


<span class='va'>car_location_edges_aggregated</span>
</code></pre>
</div>
<pre><code># A tibble: 510 x 6
   CarID_1 CarID_2 time_5              location         day   Weight
   &lt;fct&gt;   &lt;fct&gt;   &lt;fct&gt;               &lt;chr&gt;            &lt;ord&gt;  &lt;int&gt;
 1 1       5       2014-01-16 20:23:00 Ouzeri Elian     Thu        1
 2 1       6       2014-01-07 13:33:00 Gelatogalore     Tue        1
 3 1       8       2014-01-15 13:38:00 Ouzeri Elian     Wed        1
 4 1       9       2014-01-07 13:43:00 Kalami Kafenion  Tue        1
 5 1       12      2014-01-07 07:48:00 Hallowed Grounds Tue        1
 6 1       12      2014-01-07 13:43:00 Kalami Kafenion  Tue        1
 7 1       12      2014-01-08 20:58:00 General Grocer   Wed        1
 8 1       12      2014-01-09 14:03:00 Ouzeri Elian     Thu        1
 9 1       12      2014-01-10 07:48:00 Hallowed Grounds Fri        1
10 1       12      2014-01-11 14:13:00 Kalami Kafenion  Sat        1
# ... with 500 more rows</code></pre>
</div>
<p>Next, we will drop those truck values which are NA from the car assignment dataset to prevent any error from forming during the network analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_nodes_with_truck</span> <span class='op'>&lt;-</span> <span class='va'>car_unite</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>CarID</span>, <span class='va'>name</span>,<span class='va'>CurrentEmploymentType</span>,<span class='va'>CurrentEmploymentTitle</span><span class='op'>)</span>

<span class='va'>car_nodes</span> <span class='op'>&lt;-</span> <span class='va'>car_nodes_with_truck</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>CarID</span><span class='op'>)</span>

<span class='va'>car_nodes</span>
</code></pre>
</div>
<pre><code># A tibble: 35 x 4
   CarID name              CurrentEmploymentType CurrentEmploymentTit~
   &lt;fct&gt; &lt;chr&gt;             &lt;chr&gt;                 &lt;chr&gt;                
 1 1     Calixto, Nils     Information Technolo~ IT Helpdesk          
 2 2     Azada, Lars       Engineering           Engineer             
 3 3     Balas, Felix      Engineering           Engineer             
 4 4     Barranco, Ingrid  Executive             SVP/CFO              
 5 5     Baza, Isak        Information Technolo~ IT Technician        
 6 6     Bergen, Linnea    Information Technolo~ IT Group Manager     
 7 7     Orilla, Elsa      Engineering           Drill Technician     
 8 8     Alcazar, Lucas    Information Technolo~ IT Technician        
 9 9     Cazar, Gustav     Engineering           Drill Technician     
10 10    Campo-Corrente, ~ Executive             SVP/CIO              
# ... with 25 more rows</code></pre>
</div>
<p>Next, a tbl_grpah is used to manipulate tidygraph. This is use to prepare for network analysis by indicating the nodes and edges.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_location_graph</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_graph</span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>car_nodes</span>,
                                edges <span class='op'>=</span> <span class='va'>car_location_edges_aggregated</span>,
                                directed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>car_location_graph</span>
</code></pre>
</div>
<pre><code># A tbl_graph: 35 nodes and 510 edges
#
# A directed multigraph with 6 components
#
# Node Data: 35 x 4 (active)
  CarID name             CurrentEmploymentType  CurrentEmploymentTitle
  &lt;fct&gt; &lt;chr&gt;            &lt;chr&gt;                  &lt;chr&gt;                 
1 1     Calixto, Nils    Information Technology IT Helpdesk           
2 2     Azada, Lars      Engineering            Engineer              
3 3     Balas, Felix     Engineering            Engineer              
4 4     Barranco, Ingrid Executive              SVP/CFO               
5 5     Baza, Isak       Information Technology IT Technician         
6 6     Bergen, Linnea   Information Technology IT Group Manager      
# ... with 29 more rows
#
# Edge Data: 510 x 6
   from    to time_5              location     day   Weight
  &lt;int&gt; &lt;int&gt; &lt;fct&gt;               &lt;chr&gt;        &lt;ord&gt;  &lt;int&gt;
1     1     2 2014-01-16 20:23:00 Ouzeri Elian Thu        1
2     1     3 2014-01-07 13:33:00 Gelatogalore Tue        1
3     1     4 2014-01-15 13:38:00 Ouzeri Elian Wed        1
# ... with 507 more rows</code></pre>
</div>
<p>Next, we will create a facet grid of each employment type to see their relationship. If we notice, the executive does not have any links in between which indicates that their relationship is not that close as compared to engineering and security.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>set_graph_style</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'>ggraph</span><span class='op'>(</span><span class='va'>car_location_graph</span>,
layout <span class='op'>=</span>
<span class='st'>"nicely"</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_edge_link</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>width<span class='op'>=</span><span class='va'>Weight</span><span class='op'>)</span>,
alpha<span class='op'>=</span>
<span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>scale_edge_width</span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_node_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>,
size <span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>g</span> <span class='op'>+</span> <span class='fu'>facet_nodes</span><span class='op'>(</span><span class='op'>~</span><span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>th_foreground</span><span class='op'>(</span>foreground <span class='op'>=</span><span class='st'>"grey80"</span>,
border <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span><span class='st'>'bottom'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>Next, we will conduct a betweeness centrality for our network analysis. We can see that security and engineering has bigger circle which indicates that they are in between many other nodes which shows that they are close to others.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>car_location_graph</span> <span class='op'>%&gt;%</span>
<span class='fu'>mutate</span><span class='op'>(</span>betweenness_centrality <span class='op'>=</span> <span class='fu'>centrality_betweenness</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>ggraph</span><span class='op'>(</span>layout <span class='op'>=</span>
<span class='st'>"fr"</span>
<span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_edge_link</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>width<span class='op'>=</span><span class='va'>Weight</span><span class='op'>)</span>,
alpha<span class='op'>=</span>
<span class='fl'>0.2</span>
<span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>scale_edge_width</span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_node_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span>,
size<span class='op'>=</span><span class='va'>betweenness_centrality</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>g</span> <span class='op'>+</span> <span class='fu'>theme_graph</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<p>Next, we will visualize any possible community. A size of more than 1 indicates a community between groups of people. If we are able to see, those with size more than 1 are of the engineering department which shows that they have closely link with one another.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>car_location_graph</span> <span class='op'>%&gt;%</span>
<span class='fu'>mutate</span><span class='op'>(</span>community <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'>group_edge_betweenness</span><span class='op'>(</span>weights <span class='op'>=</span> <span class='va'>Weight</span>, directed <span class='op'>=</span>
<span class='cn'>TRUE</span>
<span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>ggraph</span><span class='op'>(</span>layout <span class='op'>=</span>
<span class='st'>"fr"</span>
<span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_edge_link</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>width<span class='op'>=</span><span class='va'>Weight</span><span class='op'>)</span>,
alpha<span class='op'>=</span>
<span class='fl'>0.2</span>
<span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>scale_edge_width</span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
<span class='fl'>0.1</span>
,
<span class='fl'>5</span>
<span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>geom_node_point</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>community</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>g</span> <span class='op'>+</span> <span class='fu'>theme_graph</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="vast-challenge-assignment-part-5_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>Next, we will prepare for the interactive network analysis using visNetwork.</p>
<p>First, we will rename the CarID to id and current employment type to group which is required for visNetwork.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_nodes_rename</span> <span class='op'>&lt;-</span> <span class='va'>car_nodes</span><span class='op'>%&gt;%</span>
  <span class='fu'>rename</span><span class='op'>(</span>id <span class='op'>=</span> <span class='va'>CarID</span>, group <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next we will conduct the data preparation for visNetwork</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_location_edges_aggregated_vis</span> <span class='op'>&lt;-</span> <span class='va'>car_location_edges</span> <span class='op'>%&gt;%</span>
<span class='fu'>left_join</span><span class='op'>(</span><span class='va'>car_nodes_rename</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name_1"</span><span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>rename</span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>left_join</span><span class='op'>(</span><span class='va'>car_nodes_rename</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name_2"</span><span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>rename</span><span class='op'>(</span>to <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>group_by</span><span class='op'>(</span><span class='va'>from</span>,<span class='va'>to</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>summarise</span><span class='op'>(</span>weight <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>weight</span> <span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we will create the visNetwork network analysis. Notice that the visNetwork is interactive whereby the CarID can be chosen to see the relationship between each CarID.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>visNetwork</span><span class='op'>(</span><span class='va'>car_nodes_rename</span>,
<span class='va'>car_location_edges_aggregated_vis</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>visIgraphLayout</span><span class='op'>(</span>layout <span class='op'>=</span>
<span class='st'>"layout_with_fr"</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>visOptions</span><span class='op'>(</span>highlightNearest <span class='op'>=</span>
<span class='cn'>TRUE</span>
,
nodesIdSelection <span class='op'>=</span>
<span class='cn'>TRUE</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>visLegend</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
<span class='fu'>visLayout</span><span class='op'>(</span>randomSeed <span class='op'>=</span>
<span class='fl'>123</span>
<span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-cb36cdf90dc407c8880e" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-cb36cdf90dc407c8880e">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35"],"name":["Calixto, Nils","Azada, Lars","Balas, Felix","Barranco, Ingrid","Baza, Isak","Bergen, Linnea","Orilla, Elsa","Alcazar, Lucas","Cazar, Gustav","Campo-Corrente, Ada","Calzas, Axel","Cocinaro, Hideki","Ferro, Inga","Dedos, Lidelse","Bodrogi, Loreto","Vann, Isia","Flecha, Sven","Frente, Birgitta","Frente, Vira","Fusil, Stenig","Osvaldo, Hennie","Nubarron, Adra","Lagos, Varja","Mies, Minke","Herrero, Kanon","Onda, Marin","Orilla, Kare","Borrasca, Isande","Ovan, Bertrand","Resumir, Felix","Sanjorge Jr., Sten","Strum, Orhan","Tempestad, Brand","Vann, Edvard","Vasco-Pais, Willem"],"group":["Information Technology","Engineering","Engineering","Executive","Information Technology","Information Technology","Engineering","Information Technology","Engineering","Executive","Engineering","Security","Security","Engineering","Security","Security","Information Technology","Engineering","Engineering","Security","Security","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Facilities","Security","Executive","Executive","Engineering","Security","Executive"],"CurrentEmploymentTitle":["IT Helpdesk","Engineer","Engineer","SVP/CFO","IT Technician","IT Group Manager","Drill Technician","IT Technician","Drill Technician","SVP/CIO","Hydraulic Technician","Site Control","Site Control","Engineering Group Manager","Site Control","Perimeter Control","IT Technician","Geologist","Hydraulic Technician","Building Control","Perimeter Control","Badging Office","Badging Office","Perimeter Control","Geologist","Drill Site Manager","Drill Technician","Drill Technician","Facilities Group Manager","Security Group Manager","President/CEO","SVP/COO","Drill Technician","Perimeter Control","Environmental Safety Advisor"],"x":[-0.420945199571517,0.240245160051181,0.225695179402162,-0.270606816826311,-0.0296636373515596,-0.994450683009638,-0.231159377638449,-1,0.367550586785714,-0.0345557044696708,0.128807380947261,-0.289288878836922,-0.664316136070779,-0.356399080520063,-0.459612801597567,0.309002375943209,-0.924783467660332,-0.312775374281941,0.397879903863167,0.834194289260704,-0.818099232308793,-0.690268551174007,1,0.975692428471395,-0.900845471814293,-0.444924169306203,-0.157283700320384,-0.425208713741489,0.0790294876734274,-0.658333663679514,-0.0264376511793414,0.774812292270868,0.573597957780992,-0.616108618641035,-0.259320440499148],"y":[0.178120899988774,-0.718949781177889,-0.604577101193186,-0.703544685924326,-0.907817324075854,0.516435749457236,-0.865976368190798,-0.127657856791367,-0.499239875495798,-0.742089245351253,-0.445239739097438,0.238926669162699,-0.0321518168476024,0.0215196907759407,0.00340188944652264,0.896385032870595,0.0784355761567483,-0.190563717950316,-0.612980617676092,0.519668033613687,-0.295365926464418,0.0854982456181581,0.0080268442807534,-0.361889592146911,0.270110012498505,-0.281793796659667,0.126527050296513,0.99589849667426,0.316094100962127,-0.173938330722296,1,0.231280966733727,0.715722608862045,-0.371503511922118,-1],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35"]},"edges":{"from":["1","1","1","1","1","1","2","2","2","2","2","2","3","3","3","3","3","3","4","4","4","4","4","4","5","5","5","5","6","6","7","7","7","8","8","8","9","9","9","9","9","10","10","10","10","11","11","11","11","11","11","12","12","12","12","12","13","13","13","13","13","13","13","13","13","14","14","14","14","14","14","14","14","15","15","15","15","15","15","16","17","17","17","17","17","18","18","18","18","18","18","18","19","19","19","19","19","21","21","21","21","22","22","22","22","22","25","25","25","25","26","26","26","26","26","26","27","27","27","27","27","27","29","29","30","30","30","30","30","30","30","30","30","31","33","34","34","34","34","35","35","35"],"to":["1","12","13","14","15","27","2","3","5","9","11","19","2","3","9","10","11","19","4","5","7","10","26","35","2","4","5","35","6","25","4","7","10","8","17","30","2","3","9","11","19","3","4","7","10","2","3","9","11","18","19","1","12","14","15","27","1","13","17","18","21","22","25","26","30","1","12","14","15","18","22","26","27","1","12","14","15","26","30","16","8","13","17","22","25","11","13","14","18","27","30","34","2","3","9","11","19","13","21","30","34","13","14","17","22","30","6","13","17","25","4","13","14","15","26","30","1","12","14","18","27","29","27","29","8","13","15","18","21","22","26","30","34","31","33","18","21","30","34","4","5","35"],"weight":[48,16,2,2,2,2,24,6,2,7,4,6,6,24,4,2,4,7,44,4,4,5,2,2,2,4,51,3,24,4,4,20,5,27,2,2,7,4,18,5,5,2,5,5,30,4,4,5,22,2,5,16,16,2,2,2,2,69,3,3,3,3,4,3,3,2,2,50,3,5,3,2,2,2,2,3,43,2,4,28,2,3,26,2,3,2,3,5,93,2,3,2,6,7,5,5,21,3,21,4,2,3,3,2,28,2,4,4,3,65,2,3,2,2,50,2,2,2,2,2,22,2,2,29,2,3,4,3,4,2,2,84,3,5,18,2,2,3,24,2,3,23]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":["Information Technology","Engineering","Executive","Security","Facilities"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
